name: Release Pipeline

on:
  push:
    tags:
      - 'v*'

jobs:
  build-and-release:
    name: Build and Release
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up Python 3.10
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
    
    - name: Install build dependencies
      run: |
        python -m pip install --upgrade pip
        pip install build twine setuptools wheel
    
    - name: Build distribution packages
      run: |
        python -m build
    
    - name: Create release assets
      run: |
        # Crear archivo ZIP con el c√≥digo fuente
        zip -r vader-source-${GITHUB_REF#refs/tags/}.zip . -x "*.git*" "*.pyc" "__pycache__/*" "*.egg-info/*"
        
        # Crear archivo TAR.GZ
        tar -czf vader-source-${GITHUB_REF#refs/tags/}.tar.gz --exclude='.git*' --exclude='*.pyc' --exclude='__pycache__' --exclude='*.egg-info' .
    
    - name: Create GitHub Release
      uses: softprops/action-gh-release@v1
      with:
        files: |
          dist/*
          vader-source-*.zip
          vader-source-*.tar.gz
        body: |
          ## üöÄ Vader - Lenguaje de Programaci√≥n Universal
          
          ### ‚ú® Caracter√≠sticas Principales
          - **8 Lenguajes Objetivo**: Python, JavaScript, Java, C++, Rust, Go, HTML/CSS, Solidity
          - **Sintaxis Natural**: Programaci√≥n en espa√±ol conversacional
          - **Generadores de Aplicaciones**: Web, Flask, proyectos completos
          - **Testing Autom√°tico**: Suite completa de pruebas
          - **CI/CD Integrado**: Pipeline autom√°tico de calidad
          
          ### üì¶ Instalaci√≥n
          ```bash
          # Desde PyPI (pr√≥ximamente)
          pip install vader-lang
          
          # Desde c√≥digo fuente
          git clone https://github.com/tu-usuario/vader.git
          cd vader
          python -m pip install -e .
          ```
          
          ### üéØ Uso R√°pido
          ```bash
          # Transpilar c√≥digo Vader
          python src/vader.py mi_programa.vdr --target python
          
          # Generar aplicaci√≥n web
          python src/app_generator.py mi_app.vdr --type web
          
          # Generar proyecto completo
          python src/project_generator.py mi_proyecto.vdr --languages python,javascript
          ```
          
          ### üß™ Testing
          ```bash
          # Ejecutar todos los tests
          python test_transpilers.py
          python test_new_transpilers.py
          python test_flask_app_generator.py
          ```
          
          ### üìö Documentaci√≥n
          - [Gu√≠a de Inicio](docs/GETTING_STARTED.md)
          - [Sintaxis Vader](docs/SYNTAX_GUIDE.md)
          - [API Reference](docs/API_REFERENCE.md)
          - [Ejemplos](examples/)
          
          ### üêõ Reportar Issues
          Si encuentras alg√∫n problema, por favor [crea un issue](https://github.com/tu-usuario/vader/issues/new).
        draft: false
        prerelease: false
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
